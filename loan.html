<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Loan Calculator with Circular Dial</title>
  <style>
    body {
      font-family: sans-serif;
      background: #f5f5f5;
      height: 100vh;
      margin: 0;
      display: flex;
      justify-content: center;
      align-items: center;
    }

    .calculator {
      text-align: center;
      background: white;
      padding: 2rem;
      border-radius: 1rem;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
    }

    .dial {
      position: relative;
      width: 200px;
      height: 200px;
      border-radius: 50%;
      background: #e0e0e0;
      margin: 0 auto 1rem;
    }

    .dial .thumb {
      position: absolute;
      width: 30px;
      height: 30px;
      background: #007BFF;
      border: 3px solid white;
      border-radius: 50%;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -100%);
      cursor: pointer;
    }

    .dial .center {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      font-weight: bold;
      color: #333;
    }

    .output {
      margin-top: 1rem;
    }

    .value {
      font-size: 1.3rem;
      font-weight: bold;
      color: #007BFF;
    }
  </style>
</head>
<body>

  <div class="calculator">
    <div class="dial" id="dial">
      <div class="thumb" id="thumb"></div>
      <div class="center" id="loanValue">$5000</div>
    </div>
    <div class="output">
      <h3>Monthly Payment</h3>
      <div class="value" id="monthlyPayment">$263.53</div>
    </div>
  </div>

  <script>
    const dial = document.getElementById('dial');
    const thumb = document.getElementById('thumb');
    const loanValue = document.getElementById('loanValue');
    const monthlyPayment = document.getElementById('monthlyPayment');

    const min = 1000;
    const max = 10000;
    let value = 5000;

    function calculatePayment(amount, rate = 0.05, months = 23) {
      const r = rate / 12;
      const payment = (amount * r) / (1 - Math.pow(1 + r, -months));
      return payment.toFixed(2);
    }

    function updateUI(val) {
      loanValue.textContent = `$${val}`;
      monthlyPayment.textContent = `$${calculatePayment(val)}`;
    }

    function setThumbAngle(angle) {
      const radius = 90;
      const x = radius * Math.cos(angle) + 100;
      const y = radius * Math.sin(angle) + 100;
      thumb.style.left = `${x}px`;
      thumb.style.top = `${y}px`;
    }

    function angleToValue(angle) {
      const percent = angle / (2 * Math.PI);
      return Math.round(min + percent * (max - min));
    }

    function valueToAngle(val) {
      return ((val - min) / (max - min)) * 2 * Math.PI;
    }

    function handleDrag(event) {
      const rect = dial.getBoundingClientRect();
      const centerX = rect.left + rect.width / 2;
      const centerY = rect.top + rect.height / 2;
      const x = (event.touches ? event.touches[0].clientX : event.clientX) - centerX;
      const y = (event.touches ? event.touches[0].clientY : event.clientY) - centerY;
      let angle = Math.atan2(y, x);
      if (angle < 0) angle += 2 * Math.PI;

      value = angleToValue(angle);
      updateUI(value);
      setThumbAngle(angle);
    }

    thumb.addEventListener('mousedown', startDrag);
    thumb.addEventListener('touchstart', startDrag);

    function startDrag(e) {
      e.preventDefault();
      document.addEventListener('mousemove', handleDrag);
      document.addEventListener('touchmove', handleDrag);
      document.addEventListener('mouseup', stopDrag);
      document.addEventListener('touchend', stopDrag);
    }

    function stopDrag() {
      document.removeEventListener('mousemove', handleDrag);
      document.removeEventListener('touchmove', handleDrag);
      document.removeEventListener('mouseup', stopDrag);
      document.removeEventListener('touchend', stopDrag);
    }

    // Init position
    const initialAngle = valueToAngle(value);
    setThumbAngle(initialAngle);
    updateUI(value);
  </script>

</body>
</html>