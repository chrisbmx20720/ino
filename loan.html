<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Loan Calculator - Circular Slider</title>
  <style>
    body {
      font-family: sans-serif;
      background: #f0f4f8;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      height: 100vh;
    }

    .calculator {
      background: white;
      padding: 2rem;
      border-radius: 1rem;
      box-shadow: 0 4px 20px rgba(0,0,0,0.1);
      text-align: center;
    }

    .dial {
      position: relative;
      width: 250px;
      height: 250px;
      border-radius: 50%;
      background: conic-gradient(#007bff 0% 50%, #ccc 50% 100%);
      margin: 0 auto 1rem;
    }

    .thumb {
      position: absolute;
      width: 30px;
      height: 30px;
      background: #007bff;
      border: 3px solid white;
      border-radius: 50%;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -100%);
      cursor: pointer;
    }

    .center-value {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      font-size: 1.2rem;
      font-weight: bold;
    }

    .result {
      margin-top: 1rem;
      font-size: 1.1rem;
    }

    .value {
      font-weight: bold;
      font-size: 1.5rem;
      color: #007bff;
    }
  </style>
</head>
<body>

  <div class="calculator">
    <div class="dial" id="dial">
      <div class="thumb" id="thumb"></div>
      <div class="center-value" id="loanAmount">$5000</div>
    </div>
    <div class="result">
      Monthly Payment: <span class="value" id="monthlyPayment">$219.36</span>
    </div>
  </div>

  <script>
    const dial = document.getElementById('dial');
    const thumb = document.getElementById('thumb');
    const loanAmountDisplay = document.getElementById('loanAmount');
    const monthlyPaymentDisplay = document.getElementById('monthlyPayment');

    const radius = 100;
    const minLoan = 1000;
    const maxLoan = 10000;

    let dragging = false;

    function angleFromEvent(e) {
      const rect = dial.getBoundingClientRect();
      const x = (e.touches ? e.touches[0].clientX : e.clientX) - (rect.left + rect.width / 2);
      const y = (e.touches ? e.touches[0].clientY : e.clientY) - (rect.top + rect.height / 2);
      return Math.atan2(y, x);
    }

    function angleToValue(angle) {
      if (angle < 0) angle += 2 * Math.PI;
      const percent = angle / (2 * Math.PI);
      return Math.round(minLoan + percent * (maxLoan - minLoan));
    }

    function updateThumb(angle) {
      const x = radius * Math.cos(angle) + 125;
      const y = radius * Math.sin(angle) + 125;
      thumb.style.left = `${x}px`;
      thumb.style.top = `${y}px`;

      const loan = angleToValue(angle);
      loanAmountDisplay.textContent = `$${loan}`;

      const monthly = calculatePayment(loan, 0.05, 24);
      monthlyPaymentDisplay.textContent = `$${monthly}`;
    }

    function calculatePayment(principal, rate, months) {
      const r = rate / 12;
      const payment = (principal * r) / (1 - Math.pow(1 + r, -months));
      return payment.toFixed(2);
    }

    function onDrag(e) {
      if (!dragging) return;
      e.preventDefault();
      const angle = angleFromEvent(e);
      updateThumb(angle);
    }

    thumb.addEventListener('mousedown', () => dragging = true);
    document.addEventListener('mouseup', () => dragging = false);
    document.addEventListener('mousemove', onDrag);

    thumb.addEventListener('touchstart', () => dragging = true);
    document.addEventListener('touchend', () => dragging = false);
    document.addEventListener('touchmove', onDrag);

    // Initialize
    updateThumb(1.5 * Math.PI); // Default position
  </script>

</body>
</html>